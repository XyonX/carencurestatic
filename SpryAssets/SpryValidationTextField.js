var Spry;Spry||(Spry={}),Spry.Widget||(Spry.Widget={}),Spry.Widget.BrowserSniff=function(){navigator.appName.toString(),navigator.platform.toString();var t=navigator.userAgent.toString();this.mozilla=this.ie=this.opera=r=!1;var e=/Opera.([0-9\.]*)/i,i=/MSIE.([0-9\.]*)/i;if(t.match(e))r=t.match(e),this.opera=!0,this.version=parseFloat(r[1]);else if(t.match(i))r=t.match(i),this.ie=!0,this.version=parseFloat(r[1]);else if(t.match(/safari\/([\d\.]*)/i))this.safari=!0,this.version=1.4;else if(t.match(/gecko/i)){r=t.match(/rv:\s*([0-9\.]+)/i),this.mozilla=!0,this.version=parseFloat(r[1])}this.windows=this.mac=this.linux=!1,this.Platform=t.match(/windows/i)?"windows":t.match(/linux/i)?"linux":t.match(/mac/i)?"mac":t.match(/unix/i)?"unix":"unknown",this[this.Platform]=!0,this.v=this.version,this.safari&&this.mac&&this.mozilla&&(this.mozilla=!1)},Spry.is=new Spry.Widget.BrowserSniff,Spry.Widget.ValidationTextField=function(t,e,i){if("string"==typeof(e=Spry.Widget.Utils.firstValid(e,"none"))&&void 0!==Spry.Widget.ValidationTextField.ValidationDescriptors[e]){i=Spry.Widget.Utils.firstValid(i,{}),this.type=e,this.isBrowserSupported()||(i.useCharacterMasking=!1),this.init(t,i);var s=["submit"].concat(Spry.Widget.Utils.firstValid(this.options.validateOn,[]));s=s.join(","),this.validateOn=0,this.validateOn=this.validateOn|(-1!=s.indexOf("submit")?Spry.Widget.ValidationTextField.ONSUBMIT:0),this.validateOn=this.validateOn|(-1!=s.indexOf("blur")?Spry.Widget.ValidationTextField.ONBLUR:0),this.validateOn=this.validateOn|(-1!=s.indexOf("change")?Spry.Widget.ValidationTextField.ONCHANGE:0),Spry.Widget.ValidationTextField.onloadDidFire?this.attachBehaviors():Spry.Widget.ValidationTextField.loadQueue.push(this)}},Spry.Widget.ValidationTextField.ONCHANGE=1,Spry.Widget.ValidationTextField.ONBLUR=2,Spry.Widget.ValidationTextField.ONSUBMIT=4,Spry.Widget.ValidationTextField.ERROR_REQUIRED=1,Spry.Widget.ValidationTextField.ERROR_FORMAT=2,Spry.Widget.ValidationTextField.ERROR_RANGE_MIN=4,Spry.Widget.ValidationTextField.ERROR_RANGE_MAX=8,Spry.Widget.ValidationTextField.ERROR_CHARS_MIN=16,Spry.Widget.ValidationTextField.ERROR_CHARS_MAX=32,Spry.Widget.ValidationTextField.ValidationDescriptors={none:{},custom:{},integer:{characterMasking:/[\-\+\d]/,regExpFilter:/^[\-\+]?\d*$/,validation:function(t,e){if(""==t||"-"==t||"+"==t)return!1;if(!/^[\-\+]?\d*$/.test(t))return!1;e=e||{allowNegative:!1};var i=parseInt(t,10);if(isNaN(i))i=!1;else{var s=!0;void 0!==e.allowNegative&&0==e.allowNegative&&(s=!1),!s&&t<0&&(i=!1)}return i}},real:{characterMasking:/[\d\.,\-\+e]/i,regExpFilter:/^[\-\+]?\d(?:|\.,\d{0,2})|(?:|e{0,1}[\-\+]?\d{0,})$/i,validation:function(t,e){if(!/^[\+\-]?[0-9]+([\.,][0-9]+)?([eE]{0,1}[\-\+]?[0-9]+)?$/.test(t))return!1;var i=parseFloat(t);return isNaN(i)&&(i=!1),i}},currency:{formats:{dot_comma:{characterMasking:/[\d\.\,\-\+\$]/,regExpFilter:/^[\-\+]?(?:[\d\.]*)+(|\,\d{0,2})$/,validation:function(t,e){var i=!1;return(/^(\-|\+)?\d{1,3}(?:\.\d{3})*(?:\,\d{2}|)$/.test(t)||/^(\-|\+)?\d+(?:\,\d{2}|)$/.test(t))&&(t=t.toString().replace(/\./gi,"").replace(/\,/,"."),i=parseFloat(t)),i}},comma_dot:{characterMasking:/[\d\.\,\-\+\$]/,regExpFilter:/^[\-\+]?(?:[\d\,]*)+(|\.\d{0,2})$/,validation:function(t,e){var i=!1;return(/^(\-|\+)?\d{1,3}(?:\,\d{3})*(?:\.\d{2}|)$/.test(t)||/^(\-|\+)?\d+(?:\.\d{2}|)$/.test(t))&&(t=t.toString().replace(/\,/gi,""),i=parseFloat(t)),i}}}},email:{characterMasking:/[^\s]/,validation:function(t,e){return/^[\w\.-]+@[\w\.-]+\.\w+$/i.test(t)}},date:{validation:function(t,e){var i=this.dateValidationPattern,s=e.format.match(/^([mdy]+)[\.\-\/\\\s]+([mdy]+)[\.\-\/\\\s]+([mdy]+)$/i),a=t.match(i);if(null===s||null===a)return!1;for(var r=-1,n=-1,o=-1,l=1;l<s.length;l++)switch(s[l].toLowerCase()){case"dd":r=l;break;case"mm":n=l;break;case"yy":case"yyyy":o=l}if(-1!=r&&-1!=n&&-1!=o){var d=-1,h=parseInt(a[r],10),p=parseInt(a[n],10),c=parseInt(a[o],10);if(p<1||p>12)return!1;switch(p){case 1:case 3:case 5:case 7:case 8:case 10:case 12:d=31;break;case 4:case 6:case 9:case 11:d=30;break;case 2:d=4*parseInt(c/4,10)==c&&100*parseInt(c/100,10)!=c?29:28}return!(h<1||h>d)&&new Date(c,p,h)}}},time:{validation:function(t,e){var i=e.format.match(/([hmst]+)/gi),s=t.match(/(\d+|AM?|PM?)/gi);if(null!==i&&null!==s){if(i.length!=s.length)return!1;for(var a=-1,r=-1,n=-1,o=-1,l=0,d=0,h=0,p="AM",c=0;c<i.length;c++)switch(i[c].toLowerCase()){case"hh":a=c;break;case"mm":r=c;break;case"ss":n=c;break;case"t":case"tt":o=c}if(-1!=a){l=parseInt(s[a],10);if(isNaN(l)||l>("HH"==i[a]?23:12))return!1}if(-1!=r){d=parseInt(s[r],10);if(isNaN(d)||d>59)return!1}if(-1!=n){h=parseInt(s[n],10);if(isNaN(h)||h>59)return!1}if(-1!=o){p=s[o].toUpperCase();if("TT"==i[o].toUpperCase()&&!/^a|pm$/i.test(p)||"T"==i[o].toUpperCase()&&!/^a|p$/i.test(p))return!1}return new Date(2e3,0,1,l+("P"==p.charAt(0)?12:0),d,h)}return!1}},credit_card:{characterMasking:/\d/,validation:function(t,e){var i=null;switch(e.format=e.format||"ALL",e.format.toUpperCase()){case"ALL":i=/^[3-6]{1}[0-9]{12,15}$/;break;case"VISA":i=/^4[0-9]{12,15}$/;break;case"MASTERCARD":i=/^5[1-5]{1}[0-9]{14}$/;break;case"AMEX":i=/^3(4|7){1}[0-9]{13}$/;break;case"DISCOVER":i=/^6011[0-9]{12}$/;break;case"DINERSCLUB":i=/^3((0[0-5]{1}[0-9]{11})|(6[0-9]{12})|(8[0-9]{12}))$/}if(!i.test(t))return!1;for(var s=[],a=1,r="",n=t.length-1;n>=0;n--)a%2==0?(r=2*parseInt(t.charAt(n),10),s[s.length]=r.toString().charAt(0),2==r.toString().length&&(s[s.length]=r.toString().charAt(1))):(r=t.charAt(n),s[s.length]=r),a++;var o=0;for(n=0;n<s.length;n++)o+=parseInt(s[n],10);return o%10==0}},zip_code:{formats:{zip_us9:{pattern:"00000-0000"},zip_us5:{pattern:"00000"},zip_uk:{characterMasking:/[\dA-Z\s]/,validation:function(t,e){return/^[A-Z]{1,2}\d[\dA-Z]?\s?\d[A-Z]{2}$/.test(t)}},zip_canada:{characterMasking:/[\dA-Z\s]/,pattern:"A0A 0A0"},zip_custom:{}}},phone_number:{formats:{phone_us:{pattern:"(000) 000-0000"},phone_custom:{}}},social_security_number:{pattern:"000-00-0000"},ip:{characterMaskingFormats:{ipv4:/[\d\.]/i,ipv6_ipv4:/[\d\.\:A-F\/]/i,ipv6:/[\d\.\:A-F\/]/i},validation:function(t,e){return Spry.Widget.ValidationTextField.validateIP(t,e.format)}},url:{characterMasking:/[^\s]/,validation:function(t,e){var i=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,s=t.match(i);if(s&&s[4]){for(var a=s[4].split("."),r="",n=0;n<a.length;n++){if(!(r=Spry.Widget.Utils.punycode_encode(a[n],64)))return!1;r!=a[n]+"-"&&(a[n]="xn--"+r)}a=a.join("."),t=t.replace(i,"$1//"+a+"$5$6$8")}var o=t.match(/^(?:https?|ftp)\:\/\/(?:(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=:]|%[0-9a-f]{2,2})*\@)?(?:((?:(?:[a-z0-9][a-z0-9\-]*[a-z0-9]|[a-z0-9])\.)*(?:[a-z][a-z0-9\-]*[a-z0-9]|[a-z])|(?:\[[^\]]*\]))(?:\:[0-9]*)?)(?:\/(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@]|%[0-9a-f]{2,2})*)*(?:\?(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@\/\?]|%[0-9a-f]{2,2})*)?(?:\#(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@\/\?]|%[0-9a-f]{2,2})*)?$/i);if(o){var l=o[1];if(l){if("[]"==l)return!1;var d=l.charAt(0),h=l.charAt(l.length-1);return!("["==d&&"]"!=h||"["!=d&&"]"==h)&&("["==d&&"]"==h?(l=l.replace(/^\[|\]$/gi,""),Spry.Widget.ValidationTextField.validateIP(l,"ipv6_ipv4")):!!/[^0-9\.]/.test(l)||Spry.Widget.ValidationTextField.validateIP(l,"ipv4"))}return!0}return!1}}},Spry.Widget.ValidationTextField.validateIP=function(t,e){var i=[];"ipv6"!=e&&"ipv6_ipv4"!=e||(i=i.concat([/^(?:[a-f0-9]{1,4}:){7}[a-f0-9]{1,4}(?:\/\d{1,3})?$/i,/^[a-f0-9]{0,4}::(?:\/\d{1,3})?$/i,/^:(?::[a-f0-9]{1,4}){1,6}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){1,6}:(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:)(?::[a-f0-9]{1,4}){1,6}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){2}(?::[a-f0-9]{1,4}){1,5}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){3}(?::[a-f0-9]{1,4}){1,4}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){4}(?::[a-f0-9]{1,4}){1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){5}(?::[a-f0-9]{1,4}){1,2}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){6}(?::[a-f0-9]{1,4})(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){6}(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^:(?::[a-f0-9]{1,4}){0,4}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){1,5}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:)(?::[a-f0-9]{1,4}){1,4}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){2}(?::[a-f0-9]{1,4}){1,3}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){3}(?::[a-f0-9]{1,4}){1,2}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){4}(?::[a-f0-9]{1,4}):(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i])),"ipv4"!=e&&"ipv6_ipv4"!=e||(i=i.concat([/^(\d{1,3}\.){3}\d{1,3}$/i]));for(var s=!1,a=0;a<i.length;a++)if(i[a].test(t)){s=!0;break}if(s&&-1!=t.indexOf(".")){var r=t.match(/:?(?:\d{1,3}\.){3}\d{1,3}/i);if(!r)return!1;var n=(r=r[0].replace(/^:/,"")).split(".");if(4!=n.length)return!1;var o=/^[\-\+]?\d*$/;for(a=0;a<n.length;a++){if(""==n[a])return!1;var l=parseInt(n[a],10);if(isNaN(l)||l>255||!o.test(n[a])||n[a].length>3||/^0{2,3}$/.test(n[a]))return!1}}if(s&&-1!=t.indexOf("/")){var d=t.match(/\/\d{1,3}$/);if(!d)return!1;var h=parseInt(d[0].replace(/^\//,""),10);if(isNaN(h)||h>128||h<1)return!1}return s},Spry.Widget.ValidationTextField.onloadDidFire=!1,Spry.Widget.ValidationTextField.loadQueue=[],Spry.Widget.ValidationTextField.prototype.isBrowserSupported=function(){return Spry.is.ie&&Spry.is.v>=5&&Spry.is.windows||Spry.is.mozilla&&Spry.is.v>=1.4||Spry.is.safari||Spry.is.opera&&Spry.is.v>=9},Spry.Widget.ValidationTextField.prototype.init=function(element,options){switch(this.element=this.getElement(element),this.errors=0,this.flags={locked:!1},this.options={},this.event_handlers=[],this.validClass="textfieldValidState",this.focusClass="textfieldFocusState",this.requiredClass="textfieldRequiredState",this.invalidFormatClass="textfieldInvalidFormatState",this.invalidRangeMinClass="textfieldMinValueState",this.invalidRangeMaxClass="textfieldMaxValueState",this.invalidCharsMinClass="textfieldMinCharsState",this.invalidCharsMaxClass="textfieldMaxCharsState",this.textfieldFlashTextClass="textfieldFlashText",Spry.is.safari&&(this.flags.lastKeyPressedTimeStamp=0),this.type){case"phone_number":options.format=Spry.Widget.Utils.firstValid(options.format,"phone_us");break;case"currency":options.format=Spry.Widget.Utils.firstValid(options.format,"comma_dot");break;case"zip_code":options.format=Spry.Widget.Utils.firstValid(options.format,"zip_us5");break;case"date":options.format=Spry.Widget.Utils.firstValid(options.format,"mm/dd/yy");break;case"time":options.format=Spry.Widget.Utils.firstValid(options.format,"HH:mm"),options.pattern=options.format.replace(/[hms]/gi,"0").replace(/TT/gi,"AM").replace(/T/gi,"A");break;case"ip":options.format=Spry.Widget.Utils.firstValid(options.format,"ipv4"),options.characterMasking=Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].characterMaskingFormats[options.format]}var validationDescriptor={};options.format&&Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats?Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats[options.format]&&Spry.Widget.Utils.setOptions(validationDescriptor,Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats[options.format]):Spry.Widget.Utils.setOptions(validationDescriptor,Spry.Widget.ValidationTextField.ValidationDescriptors[this.type]),options.useCharacterMasking=Spry.Widget.Utils.firstValid(options.useCharacterMasking,!1),options.hint=Spry.Widget.Utils.firstValid(options.hint,""),options.isRequired=Spry.Widget.Utils.firstValid(options.isRequired,!0),options.characterMasking=Spry.Widget.Utils.firstValid(options.characterMasking,validationDescriptor.characterMasking),options.regExpFilter=Spry.Widget.Utils.firstValid(options.regExpFilter,validationDescriptor.regExpFilter),options.pattern=Spry.Widget.Utils.firstValid(options.pattern,validationDescriptor.pattern),options.validation=Spry.Widget.Utils.firstValid(options.validation,validationDescriptor.validation),"string"==typeof options.validation&&(options.validation=eval(options.validation)),options.minValue=Spry.Widget.Utils.firstValid(options.minValue,validationDescriptor.minValue),options.maxValue=Spry.Widget.Utils.firstValid(options.maxValue,validationDescriptor.maxValue),options.minChars=Spry.Widget.Utils.firstValid(options.minChars,validationDescriptor.minChars),options.maxChars=Spry.Widget.Utils.firstValid(options.maxChars,validationDescriptor.maxChars),Spry.Widget.Utils.setOptions(this,options),Spry.Widget.Utils.setOptions(this.options,options)},Spry.Widget.ValidationTextField.prototype.destroy=function(){for(var t=0;t<this.event_handlers.length;t++)Spry.Widget.Utils.removeEventListener(this.event_handlers[t][0],this.event_handlers[t][1],this.event_handlers[t][2],!1);try{delete this.element}catch(t){}try{delete this.input}catch(t){}try{delete this.form}catch(t){}try{delete this.event_handlers}catch(t){}try{this.selection.destroy()}catch(t){}try{delete this.selection}catch(t){}var e=Spry.Widget.Form.onSubmitWidgetQueue,i=e.length;for(t=0;t<i;t++)if(e[t]==this){e.splice(t,1);break}},Spry.Widget.ValidationTextField.prototype.attachBehaviors=function(){if(this.element&&("INPUT"==this.element.nodeName?this.input=this.element:this.input=Spry.Widget.Utils.getFirstChildWithNodeNameAtAnyLevel(this.element,"INPUT")),this.input){this.maxChars&&this.input.removeAttribute("maxLength"),this.putHint(),this.compilePattern(),"date"==this.type&&this.compileDatePattern(),this.input.setAttribute("AutoComplete","off"),this.selection=new Spry.Widget.SelectionDescriptor(this.input),this.oldValue=this.input.value;var t=this;this.event_handlers=[],this.event_handlers.push([this.input,"keydown",function(e){return!!t.isDisabled()||t.onKeyDown(e||event)}]),this.event_handlers.push([this.input,"keypress",function(e){return!!t.isDisabled()||t.onKeyPress(e||event)}]),Spry.is.opera&&this.event_handlers.push([this.input,"keyup",function(e){return!!t.isDisabled()||t.onKeyUp(e||event)}]),this.event_handlers.push([this.input,"focus",function(e){return!!t.isDisabled()||t.onFocus(e||event)}]),this.event_handlers.push([this.input,"blur",function(e){return!!t.isDisabled()||t.onBlur(e||event)}]),this.event_handlers.push([this.input,"mousedown",function(e){return!!t.isDisabled()||t.onMouseDown(e||event)}]);var e=Spry.is.mozilla||Spry.is.opera||Spry.is.safari?"input":Spry.is.ie?"propertychange":"change";this.event_handlers.push([this.input,e,function(e){return!!t.isDisabled()||t.onChange(e||event)}]),Spry.is.mozilla||Spry.is.safari?this.event_handlers.push([this.input,"dragdrop",function(e){return!!t.isDisabled()||(t.removeHint(),t.onChange(e||event))}]):Spry.is.ie&&this.event_handlers.push([this.input,"drop",function(e){return!!t.isDisabled()||t.onDrop(e||event)}]);for(var i=0;i<this.event_handlers.length;i++)Spry.Widget.Utils.addEventListener(this.event_handlers[i][0],this.event_handlers[i][1],this.event_handlers[i][2],!1);this.form=Spry.Widget.Utils.getFirstParentWithNodeName(this.input,"FORM"),this.form&&(this.form.attachedSubmitHandler||this.form.onsubmit||(this.form.onsubmit=function(t){return t=t||event,Spry.Widget.Form.onSubmit(t,t.srcElement||t.currentTarget)},this.form.attachedSubmitHandler=!0),this.form.attachedResetHandler||(Spry.Widget.Utils.addEventListener(this.form,"reset",function(t){return t=t||event,Spry.Widget.Form.onReset(t,t.srcElement||t.currentTarget)},!1),this.form.attachedResetHandler=!0),Spry.Widget.Form.onSubmitWidgetQueue.push(this))}},Spry.Widget.ValidationTextField.prototype.isDisabled=function(){return this.input&&(this.input.disabled||this.input.readOnly)||!this.input},Spry.Widget.ValidationTextField.prototype.getElement=function(t){return t&&"string"==typeof t?document.getElementById(t):t},Spry.Widget.ValidationTextField.addLoadListener=function(t){void 0!==window.addEventListener?window.addEventListener("load",t,!1):void 0!==document.addEventListener?document.addEventListener("load",t,!1):void 0!==window.attachEvent&&window.attachEvent("onload",t)},Spry.Widget.ValidationTextField.processLoadQueue=function(t){Spry.Widget.ValidationTextField.onloadDidFire=!0;for(var e=Spry.Widget.ValidationTextField.loadQueue,i=e.length,s=0;s<i;s++)e[s].attachBehaviors()},Spry.Widget.ValidationTextField.addLoadListener(Spry.Widget.ValidationTextField.processLoadQueue),Spry.Widget.ValidationTextField.addLoadListener(function(){Spry.Widget.Utils.addEventListener(window,"unload",Spry.Widget.Form.destroyAll,!1)}),Spry.Widget.ValidationTextField.prototype.setValue=function(t){this.flags.locked=!0,this.input.value=t,this.flags.locked=!1,this.oldValue=t,Spry.is.ie||this.onChange()},Spry.Widget.ValidationTextField.prototype.saveState=function(){this.oldValue=this.input.value,this.selection.update()},Spry.Widget.ValidationTextField.prototype.revertState=function(t){t!=this.input.value&&(this.input.readOnly=!0,this.input.value=t,this.input.readOnly=!1,Spry.is.safari&&this.flags.active&&this.input.focus()),this.selection.moveTo(this.selection.start,this.selection.end),this.redTextFlash()},Spry.Widget.ValidationTextField.prototype.removeHint=function(){this.flags.hintOn&&(this.input.value="",this.flags.hintOn=!1)},Spry.Widget.ValidationTextField.prototype.putHint=function(){this.hint&&this.input&&"text"==this.input.type&&""==this.input.value&&(this.flags.hintOn=!0,this.input.value=this.hint)},Spry.Widget.ValidationTextField.prototype.redTextFlash=function(){var t=this;this.addClassName(this.element,this.textfieldFlashTextClass),setTimeout(function(){t.removeClassName(t.element,t.textfieldFlashTextClass)},100)},Spry.Widget.ValidationTextField.prototype.doValidations=function(t,e){if(this.isDisabled())return!1;if(this.flags.locked)return!1;if(0==t.length&&!this.isRequired)return this.errors=0,!1;this.flags.locked=!0;var i=!1,s=!0;this.options.isRequired||0!=t.length||(s=!1);var a=0,r=t;if(this.useCharacterMasking&&this.characterMasking)for(var n=0;n<t.length;n++)if(!this.characterMasking.test(t.charAt(n))){a|=Spry.Widget.ValidationTextField.ERROR_FORMAT,r=e,i=!0;break}(!i&&this.useCharacterMasking&&this.regExpFilter&&(this.regExpFilter.test(r)||(a|=Spry.Widget.ValidationTextField.ERROR_FORMAT,i=!0)),!i&&this.pattern)&&(this.patternToRegExp(t.length).test(t)?this.patternLength!=t.length&&(a|=Spry.Widget.ValidationTextField.ERROR_FORMAT):(a|=Spry.Widget.ValidationTextField.ERROR_FORMAT,i=!0));if(""==r&&(a|=Spry.Widget.ValidationTextField.ERROR_REQUIRED),!i&&this.pattern&&this.useCharacterMasking){var o=this.getAutoComplete(t.length);o&&(r+=o)}if(!i&&null!==this.minChars&&s&&t.length<this.minChars&&(a|=Spry.Widget.ValidationTextField.ERROR_CHARS_MIN,s=!1),!i&&null!==this.maxChars&&s&&t.length>this.maxChars&&(a|=Spry.Widget.ValidationTextField.ERROR_CHARS_MAX,s=!1),!i&&this.validation&&s){var l=this.validation(r,this.options);!1===l?(a|=Spry.Widget.ValidationTextField.ERROR_FORMAT,s=!1):this.typedValue=l}if(!i&&this.validation&&null!==this.minValue&&s){var d=this.validation(this.minValue,this.options);!1!==d&&this.typedValue<d&&(a|=Spry.Widget.ValidationTextField.ERROR_RANGE_MIN,s=!1)}if(!i&&this.validation&&null!==this.maxValue&&s){var h=this.validation(this.maxValue,this.options);!1!==h&&this.typedValue>h&&(a|=Spry.Widget.ValidationTextField.ERROR_RANGE_MAX,s=!1)}return this.useCharacterMasking&&i&&this.revertState(e),this.errors=a,this.fixedValue=r,this.flags.locked=!1,i},Spry.Widget.ValidationTextField.prototype.onChange=function(t){if(Spry.is.opera&&this.flags.operaRevertOnKeyUp)return!0;if(Spry.is.ie&&t&&"value"!=t.propertyName)return!0;if(!this.flags.drop){if(this.flags.hintOn)return!0;if(8==this.keyCode||46==this.keyCode){var e=this.doValidations(this.input.value,this.input.value);if(this.oldValue=this.input.value,(e||this.errors)&&this.validateOn&Spry.Widget.ValidationTextField.ONCHANGE){i=this;return setTimeout(function(){i.validate()},0),!0}}if((!(e=this.doValidations(this.input.value,this.oldValue))||this.errors)&&this.validateOn&Spry.Widget.ValidationTextField.ONCHANGE){i=this;setTimeout(function(){i.validate()},0)}return!0}var i=this;setTimeout(function(){i.flags.drop=!1,i.onChange(null)},0)},Spry.Widget.ValidationTextField.prototype.onKeyUp=function(t){if(this.flags.operaRevertOnKeyUp)return this.setValue(this.oldValue),Spry.Widget.Utils.stopEvent(t),this.selection.moveTo(this.selection.start,this.selection.start),this.flags.operaRevertOnKeyUp=!1,!1;this.flags.operaPasteOperation&&(window.clearInterval(this.flags.operaPasteOperation),this.flags.operaPasteOperation=null)},Spry.Widget.ValidationTextField.prototype.operaPasteMonitor=function(){this.input.value!=this.oldValue&&(this.doValidations(this.input.value,this.input.value)?(this.setValue(this.oldValue),this.selection.moveTo(this.selection.start,this.selection.start)):this.onChange())},Spry.Widget.ValidationTextField.prototype.compileDatePattern=function(){var t="",e=[],i=[],s=[],a=this.options.format.match(/^([mdy]+)([\.\-\/\\\s]+)([mdy]+)([\.\-\/\\\s]+)([mdy]+)$/i);if(null!==a)for(var r=1;r<a.length;r++)switch(a[r].toLowerCase()){case"dd":case"mm":e[r-1]="\\d{1,2}",i[r-1]="\\d\\d",t+="("+e[r-1]+")",s[r-1]=null;break;case"yy":e[r-1]="\\d{1,2}",i[r-1]="\\d\\d",t+="(\\d\\d)",s[r-1]=null;break;case"yyyy":e[r-1]="\\d{1,4}",i[r-1]="\\d\\d\\d\\d",t+="(\\d\\d\\d\\d)",s[r-1]=null;break;default:e[r-1]=i[r-1]=Spry.Widget.ValidationTextField.regExpFromChars(a[r]),t+="["+e[r-1]+"]",s[r-1]=a[r]}this.dateValidationPattern=new RegExp("^"+t+"$",""),this.dateAutocompleteCharacters=s,this.dateGroupPatterns=e,this.dateFullGroupPatterns=i,this.lastDateGroup=a.length-2},Spry.Widget.ValidationTextField.prototype.getRegExpForGroup=function(t){for(var e="^",i=0;i<=t;i++)e+=this.dateGroupPatterns[i];return e+="$",new RegExp(e,"")},Spry.Widget.ValidationTextField.prototype.getRegExpForFullGroup=function(t){for(var e="^",i=0;i<t;i++)e+=this.dateGroupPatterns[i];return e+=this.dateFullGroupPatterns[t],new RegExp(e,"")},Spry.Widget.ValidationTextField.prototype.getDateGroup=function(t,e){if(0==e)return 0;for(var i=t.substring(0,e),s=0;s<=this.lastDateGroup;s++)if(this.getRegExpForGroup(s).test(i))return s;return-1},Spry.Widget.ValidationTextField.prototype.isDateGroupFull=function(t,e){return this.getRegExpForFullGroup(e).test(t)},Spry.Widget.ValidationTextField.prototype.isValueValid=function(t,e,i){var s=t.substring(0,e);return this.getRegExpForGroup(i).test(s)},Spry.Widget.ValidationTextField.prototype.isPositionAtEndOfGroup=function(t,e,i){var s=t.substring(0,e);return this.getRegExpForFullGroup(i).test(s)},Spry.Widget.ValidationTextField.prototype.nextDateDelimiterExists=function(t,e,i){var s=this.dateAutocompleteCharacters[i+1];return!(t.length<e+s.length)&&t.substring(e,e+s.length)==s},Spry.Widget.ValidationTextField.prototype.onKeyPress=function(t){if(this.flags.skp)return this.flags.skp=!1,Spry.Widget.Utils.stopEvent(t),!1;if(t.ctrlKey||t.metaKey||!this.useCharacterMasking)return!0;if(Spry.is.opera&&this.flags.operaRevertOnKeyUp)return Spry.Widget.Utils.stopEvent(t),!1;if((8==this.keyCode||46==this.keyCode)&&this.doValidations(this.input.value,this.input.value))return!0;var e=Spry.Widget.Utils.getCharacterFromEvent(t);if(e&&this.characterMasking&&!this.characterMasking.test(e))return Spry.Widget.Utils.stopEvent(t),this.redTextFlash(),!1;if(e&&this.pattern){var i=this.patternCharacters[this.selection.start];/[ax]/i.test(i)&&(e=i.toLowerCase()==i?e.toLowerCase():e.toUpperCase());var s=this.getAutoComplete(this.selection.start);if(this.selection.start==this.oldValue.length){if(!(this.oldValue.length<this.patternLength))return Spry.Widget.Utils.stopEvent(t),this.setValue(this.input.value),!1;if(s){Spry.Widget.Utils.stopEvent(t);var a=this.oldValue.substring(0,this.selection.start)+s+e;return this.doValidations(a,this.oldValue)?(this.setValue(this.oldValue.substring(0,this.selection.start)+s),this.selection.moveTo(this.selection.start+s.length,this.selection.start+s.length)):(this.setValue(this.fixedValue),this.selection.moveTo(this.fixedValue.length,this.fixedValue.length)),!1}}else if(s)return Spry.Widget.Utils.stopEvent(t),this.selection.moveTo(this.selection.start+s.length,this.selection.start+s.length),!1;Spry.Widget.Utils.stopEvent(t);a=this.oldValue.substring(0,this.selection.start)+e+this.oldValue.substring(this.selection.start+1);return this.doValidations(a,this.oldValue)?this.selection.moveTo(this.selection.start,this.selection.start):(s=this.getAutoComplete(this.selection.start+1),this.setValue(this.fixedValue),this.selection.moveTo(this.selection.start+1+s.length,this.selection.start+1+s.length)),!1}if(e&&"date"==this.type&&this.useCharacterMasking){var r=this.getDateGroup(this.oldValue,this.selection.start);if(-1!=r){if(Spry.Widget.Utils.stopEvent(t),r%2!=0&&r++,this.isDateGroupFull(this.oldValue,r)){if(this.isPositionAtEndOfGroup(this.oldValue,this.selection.start,r)){if(r==this.lastDateGroup)return this.redTextFlash(),!1;s=this.dateAutocompleteCharacters[r+1];if(this.nextDateDelimiterExists(this.oldValue,this.selection.start,r)){s=this.dateAutocompleteCharacters[r+1];return this.selection.moveTo(this.selection.start+s.length,this.selection.start+s.length),e==s?!1:(a=this.isDateGroupFull(this.oldValue,r+2)?this.oldValue.substring(0,this.selection.start)+e+this.oldValue.substring(this.selection.start+1):this.oldValue.substring(0,this.selection.start)+e+this.oldValue.substring(this.selection.start),this.isValueValid(a,this.selection.start+1,r+2)?(this.setValue(a),this.selection.moveTo(this.selection.start+1,this.selection.start+1),!1):(this.redTextFlash(),!1))}var n=(s=this.dateAutocompleteCharacters[r+1])+e;return a=this.oldValue.substring(0,this.selection.start)+n+this.oldValue.substring(this.selection.start),this.isValueValid(a,this.selection.start+n.length,r+2)?(this.setValue(a),this.selection.moveTo(this.selection.start+n.length,this.selection.start+n.length),!1):(n=s,a=this.oldValue.substring(0,this.selection.start)+n+this.oldValue.substring(this.selection.start),this.setValue(a),this.selection.moveTo(this.selection.start+n.length,this.selection.start+n.length),this.redTextFlash(),!1)}var o=1;if(a=this.oldValue.substring(0,this.selection.start)+e+this.oldValue.substring(this.selection.start+1),this.isValueValid(a,this.selection.start+1,r)){if(this.isPositionAtEndOfGroup(a,this.selection.start+1,r)&&r!=this.lastDateGroup)if(this.nextDateDelimiterExists(a,this.selection.start+1,r)){o=1+(s=this.dateAutocompleteCharacters[r+1]).length}else{s=this.dateAutocompleteCharacters[r+1];a=this.oldValue.substring(0,this.selection.start)+e+s+this.oldValue.substring(this.selection.start+1),o=1+s.length}return this.setValue(a),this.selection.moveTo(this.selection.start+o,this.selection.start+o),!1}return this.redTextFlash(),!1}a=this.oldValue.substring(0,this.selection.start)+e+this.oldValue.substring(this.selection.start);o=1;if(this.isValueValid(a,this.selection.start+1,r)||this.isValueValid(a,this.selection.start+1,r+1)){if(e==(s=this.dateAutocompleteCharacters[r+1]))this.nextDateDelimiterExists(this.oldValue,this.selection.start,r)&&(a=this.oldValue,o=1);else if(this.isPositionAtEndOfGroup(a,this.selection.start+1,r)&&r!=this.lastDateGroup)if(this.nextDateDelimiterExists(a,this.selection.start+1,r)){o=1+(s=this.dateAutocompleteCharacters[r+1]).length}else{s=this.dateAutocompleteCharacters[r+1];a=this.oldValue.substring(0,this.selection.start)+e+s+this.oldValue.substring(this.selection.start+1),o=1+s.length}return this.setValue(a),this.selection.moveTo(this.selection.start+o,this.selection.start+o),!1}return this.redTextFlash(),!1}return!1}},Spry.Widget.ValidationTextField.prototype.onKeyDown=function(t){if(this.saveState(),this.keyCode=t.keyCode,Spry.is.opera&&(this.flags.operaPasteOperation&&(window.clearInterval(this.flags.operaPasteOperation),this.flags.operaPasteOperation=null),t.ctrlKey)){var e=Spry.Widget.Utils.getCharacterFromEvent(t);if(e&&-1!="vx".indexOf(e.toLowerCase())){var i=this;return this.flags.operaPasteOperation=window.setInterval(function(){i.operaPasteMonitor()},1),!0}}if(8!=this.keyCode&&46!=this.keyCode&&Spry.Widget.Utils.isSpecialKey(t))return!0;if((8==this.keyCode||46==this.keyCode)&&this.doValidations(this.input.value,this.input.value))return!0;if(this.useCharacterMasking&&this.pattern&&46==this.keyCode){if(t.ctrlKey)this.setValue(this.input.value.substring(0,this.selection.start));else{if(this.selection.end==this.input.value.length||this.selection.start==this.input.value.length-1)return!0;this.flags.operaRevertOnKeyUp=!0}return Spry.is.mozilla&&Spry.is.mac&&(this.flags.skp=!0),Spry.Widget.Utils.stopEvent(t),!1}if(this.useCharacterMasking&&this.pattern&&!t.ctrlKey&&8==this.keyCode){if(this.selection.start==this.input.value.length){var s=this.getAutoComplete(this.selection.start,-1);this.setValue(this.input.value.substring(0,this.input.value.length-(Spry.is.opera?0:1)-s.length)),Spry.is.opera&&(this.selection.start=this.selection.start-1-s.length,this.selection.end=this.selection.end-1-s.length)}else{if(this.selection.end==this.input.value.length)return!0;this.flags.operaRevertOnKeyUp=!0}return Spry.is.mozilla&&Spry.is.mac&&(this.flags.skp=!0),Spry.Widget.Utils.stopEvent(t),!1}return!0},Spry.Widget.ValidationTextField.prototype.onMouseDown=function(t){this.flags.active&&this.saveState()},Spry.Widget.ValidationTextField.prototype.onDrop=function(t){this.flags.drop=!0,this.removeHint(),this.saveState(),this.flags.active=!0,this.addClassName(this.element,this.focusClass)},Spry.Widget.ValidationTextField.prototype.onFocus=function(t){if(!this.flags.drop){if(this.removeHint(),this.pattern&&this.useCharacterMasking){var e=this.getAutoComplete(this.selection.start);this.setValue(this.input.value+e),this.selection.moveTo(this.input.value.length,this.input.value.length)}this.saveState(),this.flags.active=!0,this.addClassName(this.element,this.focusClass)}},Spry.Widget.ValidationTextField.prototype.onBlur=function(t){this.flags.active=!1,this.removeClassName(this.element,this.focusClass);this.doValidations(this.input.value,this.input.value);this.validateOn&Spry.Widget.ValidationTextField.ONBLUR&&this.validate();var e=this;return setTimeout(function(){e.putHint()},10),!0},Spry.Widget.ValidationTextField.prototype.compilePattern=function(){if(this.pattern){for(var t=[],e=[],i=[],s=0,a="",r="",n=0;n<this.pattern.length;n++)a=this.pattern.charAt(n),"\\"!=r?(e[s]=Spry.Widget.ValidationTextField.regExpFromChars(a),/[0ABXY\?]/i.test(a)?(t[s]=null,i[s]=a):"\\"==a?(t[s]=a,i[s]="\\"):(t[s]=a,i[s]=null),s++,r=a):(/[0ABXY\?]/i.test(a)?e[s-1]=a:e[s-1]=Spry.Widget.ValidationTextField.regExpFromChars(a),t[s-1]=a,i[s-1]=null,r="");this.autoCompleteCharacters=t,this.compiledPattern=e,this.patternCharacters=i,this.patternLength=t.length}},Spry.Widget.ValidationTextField.prototype.getAutoComplete=function(t,e){if(-1==e){for(var i="",s="";t&&(i=this.getAutoComplete(--t));)s=i;return s}for(var a="",r="",n=t;n<this.autoCompleteCharacters.length&&(r=this.autoCompleteCharacters[n]);n++)a+=r;return a},Spry.Widget.ValidationTextField.regExpFromChars=function(t){for(var e="",i="",s=0;s<t.length;s++)switch(i=t.charAt(s)){case"0":e+="\\d";break;case"A":e+="[A-Z]";break;case"a":e+="[a-z]";break;case"B":case"b":e+="[a-zA-Z]";break;case"x":e+="[0-9a-z]";break;case"X":e+="[0-9A-Z]";break;case"Y":case"y":e+="[0-9a-zA-Z]";break;case"?":e+=".";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e+=i;break;case"c":case"C":case"e":case"E":case"f":case"F":case"r":case"d":case"D":case"n":case"s":case"S":case"w":case"W":case"t":case"v":e+=i;break;default:e+="\\"+i}return e},Spry.Widget.ValidationTextField.prototype.patternToRegExp=function(t){for(var e="^",i=Math.min(this.compiledPattern.length,t),s=0;s<i;s++)e+=this.compiledPattern[s];return e+="$",e=new RegExp(e,"")},Spry.Widget.ValidationTextField.prototype.reset=function(){this.removeHint(),this.oldValue=this.input.defaultValue,this.removeClassName(this.element,this.requiredClass),this.removeClassName(this.element,this.invalidFormatClass),this.removeClassName(this.element,this.invalidRangeMinClass),this.removeClassName(this.element,this.invalidRangeMaxClass),this.removeClassName(this.element,this.invalidCharsMinClass),this.removeClassName(this.element,this.invalidCharsMaxClass),this.removeClassName(this.element,this.validClass);var t=this;setTimeout(function(){t.putHint()},10)},Spry.Widget.ValidationTextField.prototype.validate=function(){if(this.removeClassName(this.element,this.requiredClass),this.removeClassName(this.element,this.invalidFormatClass),this.removeClassName(this.element,this.invalidRangeMinClass),this.removeClassName(this.element,this.invalidRangeMaxClass),this.removeClassName(this.element,this.invalidCharsMinClass),this.removeClassName(this.element,this.invalidCharsMaxClass),this.removeClassName(this.element,this.validClass),this.validateOn&Spry.Widget.ValidationTextField.ONSUBMIT&&(this.removeHint(),this.doValidations(this.input.value,this.input.value),!this.flags.active)){var t=this;setTimeout(function(){t.putHint()},10)}return this.isRequired&&this.errors&Spry.Widget.ValidationTextField.ERROR_REQUIRED?(this.addClassName(this.element,this.requiredClass),!1):this.errors&Spry.Widget.ValidationTextField.ERROR_FORMAT?(this.addClassName(this.element,this.invalidFormatClass),!1):this.errors&Spry.Widget.ValidationTextField.ERROR_RANGE_MIN?(this.addClassName(this.element,this.invalidRangeMinClass),!1):this.errors&Spry.Widget.ValidationTextField.ERROR_RANGE_MAX?(this.addClassName(this.element,this.invalidRangeMaxClass),!1):this.errors&Spry.Widget.ValidationTextField.ERROR_CHARS_MIN?(this.addClassName(this.element,this.invalidCharsMinClass),!1):this.errors&Spry.Widget.ValidationTextField.ERROR_CHARS_MAX?(this.addClassName(this.element,this.invalidCharsMaxClass),!1):(this.addClassName(this.element,this.validClass),!0)},Spry.Widget.ValidationTextField.prototype.addClassName=function(t,e){!t||!e||t.className&&-1!=t.className.search(new RegExp("\\b"+e+"\\b"))||(t.className+=(t.className?" ":"")+e)},Spry.Widget.ValidationTextField.prototype.removeClassName=function(t,e){!t||!e||t.className&&-1==t.className.search(new RegExp("\\b"+e+"\\b"))||(t.className=t.className.replace(new RegExp("\\s*\\b"+e+"\\b","g"),""))},Spry.Widget.SelectionDescriptor=function(t){this.element=t,this.update()},Spry.Widget.SelectionDescriptor.prototype.update=function(){if(Spry.is.ie&&Spry.is.windows){if("TEXTAREA"==this.element.nodeName){var t=this.element.ownerDocument.selection.createRange();if(t.parentElement()==this.element){var e=this.element.ownerDocument.body.createTextRange();e.moveToElementText(this.element);for(var i=0;e.compareEndPoints("StartToStart",t)<0;i++)e.moveStart("character",1);this.start=i,(e=this.element.ownerDocument.body.createTextRange()).moveToElementText(this.element);for(var s=0;e.compareEndPoints("StartToEnd",t)<0;s++)e.moveStart("character",1);this.end=s,this.length=this.end-this.start,this.text=t.text}}else if("INPUT"==this.element.nodeName){this.range=this.element.ownerDocument.selection.createRange(),this.length=this.range.text.length;var a=this.range.duplicate();this.start=-a.moveStart("character",-1e4),(a=this.range.duplicate()).collapse(!1),this.end=-a.moveStart("character",-1e4),this.text=this.range.text}}else{var r=this.element,n=0,o=0;try{n=r.selectionStart}catch(t){}try{o=r.selectionEnd}catch(t){}Spry.is.safari&&(2147483647==n&&(n=0),2147483647==o&&(o=0)),this.start=n,this.end=o,this.length=o-n,this.text=this.element.value.substring(n,o)}},Spry.Widget.SelectionDescriptor.prototype.destroy=function(){try{delete this.range}catch(t){}try{delete this.element}catch(t){}},Spry.Widget.SelectionDescriptor.prototype.move=function(t){if(Spry.is.ie&&Spry.is.windows)this.range.move("character",t),this.range.select();else try{this.element.selectionStart++}catch(t){}this.update()},Spry.Widget.SelectionDescriptor.prototype.moveTo=function(t,e){if(Spry.is.ie&&Spry.is.windows){if("TEXTAREA"==this.element.nodeName){var i=this.element.createTextRange();this.range=this.element.createTextRange(),this.range.move("character",t),this.range.moveEnd("character",e-t),this.range.compareEndPoints("StartToStart",i)<0&&this.range.setEndPoint("StartToStart",i),this.range.compareEndPoints("EndToEnd",i)>0&&this.range.setEndPoint("EndToEnd",i)}else"INPUT"==this.element.nodeName&&(this.range=this.element.ownerDocument.selection.createRange(),this.range.move("character",-1e4),this.start=this.range.moveStart("character",t),this.end=this.start+this.range.moveEnd("character",e-t));this.range.select()}else{this.start=t;try{this.element.selectionStart=t}catch(t){}this.end=e;try{this.element.selectionEnd=e}catch(t){}}this.ignore=!0,this.update()},Spry.Widget.SelectionDescriptor.prototype.moveEnd=function(t){if(Spry.is.ie&&Spry.is.windows)this.range.moveEnd("character",t),this.range.select();else try{this.element.selectionEnd++}catch(t){}this.update()},Spry.Widget.SelectionDescriptor.prototype.collapse=function(t){if(Spry.is.ie&&Spry.is.windows)this.range=this.element.ownerDocument.selection.createRange(),this.range.collapse(t),this.range.select();else if(t)try{this.element.selectionEnd=this.element.selectionStart}catch(t){}else try{this.element.selectionStart=this.element.selectionEnd}catch(t){}this.update()},Spry.Widget.Form||(Spry.Widget.Form={}),Spry.Widget.Form.onSubmitWidgetQueue||(Spry.Widget.Form.onSubmitWidgetQueue=[]),Spry.Widget.Form.validate||(Spry.Widget.Form.validate=function(t){for(var e=!0,i=Spry.Widget.Form.onSubmitWidgetQueue,s=i.length,a=0;a<s;a++)i[a].isDisabled()||i[a].form!=t||(e=i[a].validate()&&e);return e}),Spry.Widget.Form.onSubmit||(Spry.Widget.Form.onSubmit=function(t,e){return 0!=Spry.Widget.Form.validate(e)}),Spry.Widget.Form.onReset||(Spry.Widget.Form.onReset=function(t,e){for(var i=Spry.Widget.Form.onSubmitWidgetQueue,s=i.length,a=0;a<s;a++)i[a].isDisabled()||i[a].form!=e||"function"!=typeof i[a].reset||i[a].reset();return!0}),Spry.Widget.Form.destroy||(Spry.Widget.Form.destroy=function(t){for(var e=Spry.Widget.Form.onSubmitWidgetQueue,i=0;i<Spry.Widget.Form.onSubmitWidgetQueue.length;i++)e[i].form==t&&"function"==typeof e[i].destroy&&(e[i].destroy(),i--)}),Spry.Widget.Form.destroyAll||(Spry.Widget.Form.destroyAll=function(){for(var t=Spry.Widget.Form.onSubmitWidgetQueue,e=0;e<Spry.Widget.Form.onSubmitWidgetQueue.length;e++)"function"==typeof t[e].destroy&&(t[e].destroy(),e--)}),Spry.Widget.Utils||(Spry.Widget.Utils={}),Spry.Widget.Utils.punycode_constants={base:36,tmin:1,tmax:26,skew:38,damp:700,initial_bias:72,initial_n:128,delimiter:45,maxint:2<<25},Spry.Widget.Utils.punycode_encode_digit=function(t){return String.fromCharCode(t+22+75*(t<26))},Spry.Widget.Utils.punycode_adapt=function(t,e,i){t=i?t/this.punycode_constants.damp:t>>1,t+=t/e;for(var s=0;t>(this.punycode_constants.base-this.punycode_constants.tmin)*this.punycode_constants.tmax/2;s+=this.punycode_constants.base)t/=this.punycode_constants.base-this.punycode_constants.tmin;return s+(this.punycode_constants.base-this.punycode_constants.tmin+1)*t/(t+this.punycode_constants.skew)},Spry.Widget.Utils.punycode_encode=function(t,e){var i=t.split("");t=[];for(var s=0;s<i.length;s++)t.push(i[s].charCodeAt(0));var a,r,n,o,l,d,h,p="",c=t.length,u=this.punycode_constants.initial_n,g=0,f=this.punycode_constants.initial_bias,y=0;for(n=0;n<c;n++)if(t[n]<128){if(e-y<2)return!1;p+=String.fromCharCode(t[n]),y++}for(a=r=y,r>0&&(p+=String.fromCharCode(this.punycode_constants.delimiter),y++);a<c;){for(o=this.punycode_constants.maxint,n=0;n<c;n++)t[n]>=u&&t[n]<o&&(o=t[n]);if(o-u>(this.punycode_constants.maxint-g)/(a+1))return!1;for(g+=(o-u)*(a+1),u=o,n=0;n<c;n++){if(t[n]<u&&0==++g)return!1;if(t[n]==u){for(l=g,d=this.punycode_constants.base;;d+=this.punycode_constants.base){if(y>=e)return!1;if(l<(h=d<=f?this.punycode_constants.tmin:d>=f+this.punycode_constants.tmax?this.punycode_constants.tmax:d-f))break;p+=this.punycode_encode_digit(h+(l-h)%(this.punycode_constants.base-h)),y++,l=(l-h)/(this.punycode_constants.base-h)}p+=this.punycode_encode_digit(l),y++,f=this.punycode_adapt(g,a+1,a==r),g=0,a++}}g++,u++}return p},Spry.Widget.Utils.setOptions=function(t,e,i){if(e)for(var s in e)i&&void 0==e[s]||(t[s]=e[s])},Spry.Widget.Utils.firstValid=function(){for(var t=null,e=0;e<Spry.Widget.Utils.firstValid.arguments.length;e++)if(void 0!==Spry.Widget.Utils.firstValid.arguments[e]){t=Spry.Widget.Utils.firstValid.arguments[e];break}return t},Spry.Widget.Utils.specialCharacters=",8,9,16,17,18,20,27,33,34,35,36,37,38,40,45,144,192,63232,",Spry.Widget.Utils.specialSafariNavKeys="63232,63233,63234,63235,63272,63273,63275,63276,63277,63289,",Spry.Widget.Utils.specialNotSafariCharacters="39,46,91,92,93,",Spry.Widget.Utils.specialCharacters+=Spry.Widget.Utils.specialSafariNavKeys,Spry.is.safari||(Spry.Widget.Utils.specialCharacters+=Spry.Widget.Utils.specialNotSafariCharacters),Spry.Widget.Utils.isSpecialKey=function(t){return-1!=Spry.Widget.Utils.specialCharacters.indexOf(","+t.keyCode+",")},Spry.Widget.Utils.getCharacterFromEvent=function(t){var e="keydown"==t.type,i=null,s=null;return Spry.is.mozilla&&!e?t.charCode?s=String.fromCharCode(t.charCode):i=t.keyCode:13!=(i=t.keyCode||t.which)&&(s=String.fromCharCode(i)),Spry.is.safari&&(e?(i=t.keyCode||t.which,s=String.fromCharCode(i)):(i=t.keyCode||t.which,s=-1!=Spry.Widget.Utils.specialCharacters.indexOf(","+i+",")?null:String.fromCharCode(i))),Spry.is.opera&&(s=-1!=Spry.Widget.Utils.specialCharacters.indexOf(","+i+",")?null:String.fromCharCode(i)),s},Spry.Widget.Utils.getFirstChildWithNodeNameAtAnyLevel=function(t,e){var i=t.getElementsByTagName(e);return i?i[0]:null},Spry.Widget.Utils.getFirstParentWithNodeName=function(t,e){for(;t.parentNode&&t.parentNode.nodeName.toLowerCase()!=e.toLowerCase()&&"BODY"!=t.parentNode.nodeName;)t=t.parentNode;return t.parentNode&&t.parentNode.nodeName.toLowerCase()==e.toLowerCase()?t.parentNode:null},Spry.Widget.Utils.destroyWidgets=function(t){"string"==typeof t&&(t=document.getElementById(t));for(var e=Spry.Widget.Form.onSubmitWidgetQueue,i=0;i<Spry.Widget.Form.onSubmitWidgetQueue.length;i++)"function"==typeof e[i].destroy&&Spry.Widget.Utils.contains(t,e[i].element)&&(e[i].destroy(),i--)},Spry.Widget.Utils.contains=function(t,e){if("object"==typeof t.contains)return e&&t&&(t==e||t.contains(e));for(var i=e;i;){if(i==t)return!0;i=i.parentNode}return!1},Spry.Widget.Utils.addEventListener=function(t,e,i,s){try{t.addEventListener?t.addEventListener(e,i,s):t.attachEvent&&t.attachEvent("on"+e,i,s)}catch(t){}},Spry.Widget.Utils.removeEventListener=function(t,e,i,s){try{t.removeEventListener?t.removeEventListener(e,i,s):t.detachEvent&&t.detachEvent("on"+e,i,s)}catch(t){}},Spry.Widget.Utils.stopEvent=function(t){try{this.stopPropagation(t),this.preventDefault(t)}catch(t){}},Spry.Widget.Utils.stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},Spry.Widget.Utils.preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1};